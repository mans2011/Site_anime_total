"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[976],{1267:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(5155),s=r(2115),n=r(6874),i=r.n(n),o=r(8350);function l(e){let{anime:t,onWatchlistChange:r}=e,[n,l]=(0,s.useState)(()=>{let e=o.x.getCurrentUser();return!!e&&e.watchlist.includes(t.mal_id)}),[c,d]=(0,s.useState)(()=>{let e=o.x.getCurrentUser();return!!e&&e.favorites.includes(t.mal_id)}),u="string"==typeof t.title?t.title:t.title_english||t.title_japanese||"T\xedtulo n\xe3o dispon\xedvel";return(0,a.jsx)(i(),{href:"/anime/".concat(t.mal_id),className:"group cursor-pointer",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"aspect-[3/4] relative overflow-hidden rounded-lg bg-gray-800",children:[(0,a.jsx)("img",{src:t.images.jpg.large_image_url||t.images.jpg.image_url,alt:u,className:"w-full h-full object-cover object-top group-hover:scale-105 transition-transform duration-300",loading:"lazy"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,a.jsxs)("div",{className:"absolute top-2 right-2 flex gap-1",children:[(0,a.jsx)("button",{onClick:e=>{if(e.preventDefault(),e.stopPropagation(),!o.x.getCurrentUser()){window.location.href="/login";return}n?(o.x.removeFromWatchlist(t.mal_id),l(!1)):(o.x.addToWatchlist(t.mal_id),l(!0)),null==r||r()},className:"w-8 h-8 rounded-full flex items-center justify-center transition-all duration-200 ".concat(n?"bg-blue-600 text-white":"bg-black/60 text-white hover:bg-blue-600"),title:n?"Remover da lista":"Adicionar \xe0 lista",children:(0,a.jsx)("i",{className:"ri-bookmark-".concat(n?"fill":"line"," text-sm")})}),(0,a.jsx)("button",{onClick:e=>{if(e.preventDefault(),e.stopPropagation(),!o.x.getCurrentUser()){window.location.href="/login";return}c?(o.x.removeFromFavorites(t.mal_id),d(!1)):(o.x.addToFavorites(t.mal_id),d(!0)),null==r||r()},className:"w-8 h-8 rounded-full flex items-center justify-center transition-all duration-200 ".concat(c?"bg-red-600 text-white":"bg-black/60 text-white hover:bg-red-600"),title:c?"Remover dos favoritos":"Adicionar aos favoritos",children:(0,a.jsx)("i",{className:"ri-heart-".concat(c?"fill":"line"," text-sm")})})]}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-white text-xs mb-2",children:[t.score&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("i",{className:"ri-star-fill text-yellow-400 mr-1"}),(0,a.jsx)("span",{children:t.score})]}),t.year&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:t.year})]}),t.episodes&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:[t.episodes," eps"]})]})]}),t.genres&&t.genres.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.genres.slice(0,2).map(e=>(0,a.jsx)("span",{className:"bg-red-600/80 text-white px-2 py-1 rounded text-xs",children:e.name},e.mal_id||e.name))})]})]}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("h3",{className:"text-white text-sm font-semibold line-clamp-2 group-hover:text-red-400 transition-colors",children:u}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-400",children:[t.score&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("i",{className:"ri-star-fill text-yellow-400 mr-1"}),(0,a.jsx)("span",{children:t.score})]}),t.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{className:"capitalize",children:t.status})]})]})]})]})})}},1741:(e,t,r)=>{r.d(t,{Gn:()=>u,Ho:()=>g,U7:()=>l,WU:()=>c,_t:()=>x,jy:()=>o,lJ:()=>m,ns:()=>d,os:()=>h,xH:()=>i});let a="https://api.jikan.moe/v4",s="https://api.themoviedb.org/3",n="7d779743f4eacd1de7ffc7882da6d63f";async function i(e){try{let t=await fetch("".concat(a,"/anime?q=").concat(encodeURIComponent(e),"&order_by=popularity"));return(await t.json()).data||[]}catch(e){return console.error("Erro ao buscar por nome:",e),[]}}async function o(e){try{let t=await fetch("".concat(a,"/anime/").concat(e));if(t.ok){let e=await t.json();if(e.data)return p(e.data)}}catch(e){console.warn("Jikan falhou, tentando AniList…",e)}try{var t;let r=await fetch("https://graphql.anilist.co",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\n      query ($id: Int) {\n        Media(id: $id, type: ANIME) {\n          id\n          title { romaji english native }\n          bannerImage\n          description(asHtml: false)\n          episodes\n          status\n          coverImage { large }\n          averageScore\n          genres { name }\n          studios { name }\n        }\n      }\n    ",variables:{id:parseInt(e.toString(),10)}})}),a=null==(t=(await r.json()).data)?void 0:t.Media;if(!a)return null;return p({mal_id:a.id,title:a.title.english||a.title.romaji||a.title.native,title_english:a.title.english,title_japanese:a.title.native,bannerImage:a.bannerImage,images:{jpg:{image_url:a.coverImage.large,large_image_url:a.coverImage.large}},synopsis:a.description,episodes:a.episodes,status:a.status,score:a.averageScore?a.averageScore/10:void 0,genres:a.genres||[],studios:a.studios||[]})}catch(e){return console.error("AniList fallback falhou:",e),null}}async function l(){try{let e=await fetch("".concat(a,"/genres/anime"));return(await e.json()).data||[]}catch(e){return console.error("Erro ao buscar g\xeaneros:",e),[]}}async function c(e){try{let t=(await l()).find(t=>t.name.toLowerCase()===e.toLowerCase());if(!t)return[];let r=await fetch("".concat(a,"/anime?genres=").concat(t.mal_id,"&limit=20"));return((await r.json()).data||[]).map(p)}catch(e){return console.error("Erro ao buscar por g\xeanero:",e),[]}}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{let t=await fetch("".concat(a,"/top/anime?filter=bypopularity&limit=").concat(e));return((await t.json()).data||[]).map(p)}catch(e){return console.error("Erro ao buscar mais vistos:",e),[]}}async function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{let t=await fetch("".concat(a,"/top/anime?limit=").concat(e));return((await t.json()).data||[]).map(p)}catch(e){return console.error("Erro ao buscar top avaliados:",e),[]}}async function m(){try{let e=await fetch("".concat(a,"/seasons/now"));return((await e.json()).data||[]).map(p)}catch(e){return console.error("Erro ao buscar temporada atual:",e),[]}}async function h(e){try{var t,r;let a=await fetch("".concat(s,"/search/tv?api_key=").concat(n)+"&query=".concat(encodeURIComponent(e))+"&language=pt-BR"),i=null==(t=(await a.json()).results)?void 0:t[0];if(!i)return null;let o=await fetch("".concat(s,"/tv/").concat(i.id)+"?api_key=".concat(n,"&language=pt-BR"));return(null==(r=(await o.json()).overview)?void 0:r.trim())||null}catch(e){return console.error("Erro na sinopse PT:",e),null}}async function g(e){try{var t;let r=await fetch("".concat(s,"/search/tv?api_key=").concat(n)+"&query=".concat(encodeURIComponent(e))+"&language=pt-BR"),a=null==(t=(await r.json()).results)?void 0:t[0];if(!a)return null;let i=await fetch("".concat(s,"/tv/").concat(a.id)+"?api_key=".concat(n,"&language=pt-BR")),o=await i.json(),l=[];for(let e of o.seasons){let t="".concat(s,"/tv/").concat(a.id,"/season/").concat(e.season_number)+"?api_key=".concat(n,"&language=pt-BR"),r=await fetch(t),i=await r.json();l.push({nome:e.name,numero:e.season_number,episodios:i.episodes.map(e=>({numero:e.episode_number,nome:e.name,imagem:e.still_path?"https://image.tmdb.org/t/p/w185".concat(e.still_path):null}))})}return{temporadas:l,episodiosTotal:o.number_of_episodes,nomeOriginal:o.original_name,status:o.status,primeiroEp:o.first_air_date}}catch(e){return console.error("Erro nos detalhes da s\xe9rie:",e),null}}function p(e){var t,r,a,s,n,i;return{mal_id:e.mal_id,title:"string"==typeof e.title?e.title:(null==(t=e.title)?void 0:t.english)||(null==(r=e.title)?void 0:r.romaji)||(null==(a=e.title)?void 0:a.native),title_english:e.title_english||("object"==typeof e.title?null==(s=e.title)?void 0:s.english:void 0),title_japanese:e.title_japanese||("object"==typeof e.title?null==(n=e.title)?void 0:n.native:void 0),images:e.images||{jpg:{image_url:""}},synopsis:e.synopsis||e.description||"",score:e.score||e.averageScore,scored_by:e.scored_by,rank:e.rank,popularity:e.popularity,members:e.members,favorites:e.favorites,status:e.status||"Unknown",rating:e.rating,source:e.source,episodes:e.episodes,duration:e.duration,year:e.year||(null==(i=e.aired)?void 0:i.from)?new Date(e.aired.from).getFullYear():void 0,season:e.season,studios:e.studios,genres:e.genres,demographics:e.demographics,themes:e.themes,aired:e.aired,trailer:e.trailer,bannerImage:e.bannerImage}}let x={async getTopAnimes(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;return{data:await u(e)}},getSeasonalAnimes:async()=>({data:(await m()).slice(0,24)}),async searchAnimes(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:(await i(e)).slice(0,24)}},getAnimeById:async e=>await o(e),async getAnimeCharacters(e){try{let t=await fetch("".concat(a,"/anime/").concat(e,"/characters"));return(await t.json()).data||[]}catch(e){return console.error("Erro ao buscar personagens:",e),[]}},async getAnimeRecommendations(e){try{let t=await fetch("".concat(a,"/anime/").concat(e,"/recommendations"));return(await t.json()).data||[]}catch(e){return console.error("Erro ao buscar recomenda\xe7\xf5es:",e),[]}},async getAnimesByGenre(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;try{let r=await fetch("".concat(a,"/anime?genres=").concat(e,"&page=").concat(t,"&limit=24"));return{data:((await r.json()).data||[]).map(p)}}catch(e){return console.error("Erro ao buscar animes por g\xeanero:",e),{data:[]}}}}},7288:(e,t,r)=>{r.d(t,{A:()=>c});var a=r(5155),s=r(2115),n=r(6874),i=r.n(n),o=r(5695),l=r(8350);function c(){let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!1),[c,d]=(0,s.useState)(""),u=(0,o.useRouter)();return(0,s.useEffect)(()=>{t(l.x.getCurrentUser());let e=()=>{t(l.x.getCurrentUser())};window.addEventListener("storage",e);let r=setInterval(()=>{t(l.x.getCurrentUser())},1e3);return()=>{window.removeEventListener("storage",e),clearInterval(r)}},[]),(0,s.useEffect)(()=>{let e=e=>{r&&(e.target.closest(".user-menu")||n(!1))};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[r]),(0,a.jsx)("header",{className:"bg-black/95 backdrop-blur-sm fixed top-0 left-0 right-0 z-50",children:(0,a.jsx)("div",{className:"px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,a.jsx)(i(),{href:"/",className:"flex items-center",children:(0,a.jsx)("span",{className:"text-red-600 text-2xl font-['Pacifico'] font-bold",children:"AnimeFlix"})}),(0,a.jsxs)("nav",{className:"hidden md:flex space-x-6",children:[(0,a.jsx)(i(),{href:"/",className:"text-white hover:text-red-500 transition-colors whitespace-nowrap cursor-pointer",children:"In\xedcio"}),(0,a.jsx)(i(),{href:"/trending",className:"text-white hover:text-red-500 transition-colors whitespace-nowrap cursor-pointer",children:"Em Alta"}),(0,a.jsx)(i(),{href:"/genres",className:"text-white hover:text-red-500 transition-colors whitespace-nowrap cursor-pointer",children:"G\xeaneros"}),e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{href:"/watchlist",className:"text-white hover:text-red-500 transition-colors whitespace-nowrap cursor-pointer",children:"Minha Lista"}),(0,a.jsx)(i(),{href:"/favorites",className:"text-white hover:text-red-500 transition-colors whitespace-nowrap cursor-pointer",children:"Favoritos"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),c.trim()&&(u.push("/search?q=".concat(encodeURIComponent(c.trim()))),d(""))},className:"hidden sm:block",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar animes...",value:c,onChange:e=>d(e.target.value),className:"bg-gray-800 text-white px-4 py-2 pr-10 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,a.jsx)("button",{type:"submit",className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,a.jsx)("i",{className:"ri-search-line text-gray-400 hover:text-white cursor-pointer"})})]})}),e?(0,a.jsxs)("div",{className:"relative user-menu",children:[(0,a.jsxs)("button",{onClick:()=>n(!r),className:"flex items-center space-x-2 text-white hover:text-red-500 cursor-pointer",children:[e.avatar?(0,a.jsx)("img",{src:e.avatar,alt:e.name,className:"w-8 h-8 rounded-full object-cover"}):(0,a.jsx)("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-bold",children:e.name.charAt(0).toUpperCase()})}),(0,a.jsx)("span",{className:"hidden md:block",children:e.name.split(" ")[0]}),(0,a.jsx)("i",{className:"ri-arrow-down-s-line"})]}),r&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-gray-900 rounded-lg shadow-lg py-2",children:[(0,a.jsxs)("div",{className:"px-4 py-2 border-b border-gray-700",children:[(0,a.jsx)("p",{className:"text-white font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:e.email})]}),(0,a.jsxs)(i(),{href:"/watchlist",className:"block px-4 py-2 text-white hover:bg-gray-800 cursor-pointer",children:[(0,a.jsx)("i",{className:"ri-bookmark-line mr-2"}),"Minha Lista (",e.watchlist.length,")"]}),(0,a.jsxs)(i(),{href:"/favorites",className:"block px-4 py-2 text-white hover:bg-gray-800 cursor-pointer",children:[(0,a.jsx)("i",{className:"ri-heart-line mr-2"}),"Favoritos (",e.favorites.length,")"]}),(0,a.jsx)("div",{className:"border-t border-gray-700 mt-2 pt-2",children:(0,a.jsxs)("button",{onClick:()=>{l.x.setCurrentUser(null),t(null),n(!1),u.push("/")},className:"w-full text-left px-4 py-2 text-white hover:bg-gray-800 cursor-pointer",children:[(0,a.jsx)("i",{className:"ri-logout-box-line mr-2"}),"Sair"]})})]})]}):(0,a.jsx)(i(),{href:"/login",className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors whitespace-nowrap cursor-pointer",children:"Entrar"})]})]})})})}},8350:(e,t,r)=>{r.d(t,{x:()=>s,z:()=>n});let a={CURRENT_USER:"animeflix_current_user",USERS:"animeflix_users",COMMENTS:"animeflix_comments"},s={getCurrentUser(){let e=localStorage.getItem(a.CURRENT_USER);return e?JSON.parse(e):null},setCurrentUser(e){e?(localStorage.setItem(a.CURRENT_USER,JSON.stringify(e)),this.saveUser(e)):localStorage.removeItem(a.CURRENT_USER)},saveUser(e){let t=this.getAllUsers(),r=t.findIndex(t=>t.id===e.id);r>=0?t[r]=e:t.push(e),localStorage.setItem(a.USERS,JSON.stringify(t))},getAllUsers(){let e=localStorage.getItem(a.USERS);return e?JSON.parse(e):[]},findUserByEmail(e){return this.getAllUsers().find(t=>t.email===e)||null},addToWatchlist(e){let t=this.getCurrentUser();t&&(t.watchlist.includes(e)||(t.watchlist.push(e),this.setCurrentUser(t)))},removeFromWatchlist(e){let t=this.getCurrentUser();t&&(t.watchlist=t.watchlist.filter(t=>t!==e),this.setCurrentUser(t))},addToFavorites(e){let t=this.getCurrentUser();t&&(t.favorites.includes(e)||(t.favorites.push(e),this.setCurrentUser(t)))},removeFromFavorites(e){let t=this.getCurrentUser();t&&(t.favorites=t.favorites.filter(t=>t!==e),this.setCurrentUser(t))},addToWatchHistory(e,t){let r=this.getCurrentUser();if(!r)return;let a=r.watchHistory.findIndex(t=>t.animeId===e),s={animeId:e,watchedAt:new Date().toISOString(),episodeNumber:t};a>=0?r.watchHistory[a]=s:r.watchHistory.unshift(s),r.watchHistory.length>100&&(r.watchHistory=r.watchHistory.slice(0,100)),this.setCurrentUser(r)},rateAnime(e,t){let r=this.getCurrentUser();if(!r)return;let a=r.ratings.findIndex(t=>t.animeId===e),s={animeId:e,rating:t,ratedAt:new Date().toISOString()};a>=0?r.ratings[a]=s:r.ratings.push(s),this.setCurrentUser(r)},getUserRating(e){let t=this.getCurrentUser();if(!t)return null;let r=t.ratings.find(t=>t.animeId===e);return r?r.rating:null}},n={getComments(e){let t=localStorage.getItem(a.COMMENTS);return(t?JSON.parse(t):[]).filter(t=>t.animeId===e).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())},addComment(e,t,r){let n=s.getCurrentUser();if(!n)return null;let i={id:Date.now().toString()+Math.random().toString(36).substr(2,9),animeId:e,userId:n.id,userName:n.name,userAvatar:n.avatar,text:t,rating:r,createdAt:new Date().toISOString()},o=localStorage.getItem(a.COMMENTS),l=o?JSON.parse(o):[];return l.push(i),localStorage.setItem(a.COMMENTS,JSON.stringify(l)),r&&s.rateAnime(e,r),i},deleteComment(e){let t=s.getCurrentUser();if(!t)return;let r=localStorage.getItem(a.COMMENTS),n=(r?JSON.parse(r):[]).filter(r=>r.id!==e||r.userId===t.id);localStorage.setItem(a.COMMENTS,JSON.stringify(n))}}}}]);